(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2060c1ca"],{2874:function(t,e,i){"use strict";var s=i("e85c"),n=i.n(s);n.a},"2a49":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grayPageBG overflow-auto"},[i("van-nav-bar",{attrs:{title:"发布任务","right-text":"说明","left-text":"返回",fixed:"","left-arrow":""},on:{"click-left":t.onNavBarLeftPressed,"click-right":t.onNavBarRightPressed}}),i("section",{staticClass:"under-nav"},[i("van-cell-group",{attrs:{title:"任务详情"}},[i("van-cell",{attrs:{title:"任务类型",value:t.missionTypeTitles[t.missionTypeIndex],"is-link":""},on:{click:function(e){t.showMissionTypePicker=!0}}}),i("van-cell",{attrs:{title:"支持设备",value:t.platformNames[t.supportPlatformIndex],"is-link":""},on:{click:function(e){t.showPlatformTypePicker=!0}}}),i("van-field",{attrs:{label:"标题",placeholder:"项目名称+核心要求，12字以内"},model:{value:t.missionTitle,callback:function(e){t.missionTitle=e},expression:"missionTitle"}}),i("van-cell",{attrs:{title:"截止时间",value:t.deadLineTimeString,"is-link":""},on:{click:function(e){t.showMissionDeadLineTimePicker=!0}}}),i("van-field",{attrs:{label:"出价",placeholder:t.pricePlaceholder,type:"number"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),i("van-field",{attrs:{label:"数量",placeholder:t.countPlaceholder,type:"number"},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}}),i("van-cell",{attrs:{title:"合计",value:t.totalPrice,label:"服务费：成交额XXX 最低XXX元"}})],1),i("van-cell-group",{attrs:{title:"审核内容"}},[i("van-collapse",{attrs:{accordion:""},model:{value:t.collapseActiveName,callback:function(e){t.collapseActiveName=e},expression:"collapseActiveName"}},[i("van-collapse-item",{attrs:{title:"审核图样",label:"上传验证图样例，最多可上传"+t.sampleImgCount+"张",name:"1"}},[i("van-swipe",{attrs:{autoplay:0,width:t.vanSwipeWidth,height:t.vanSwipeHeight,loop:!1,"show-indicators":!1}},[t._l(t.sampleImgArray,function(e,s){return i("van-swipe-item",{key:s,staticClass:"swipe-item",on:{click:function(e){return t.onSampleItemClick(s)}}},[i("img",{staticClass:"swipe-img",staticStyle:{position:"relative"},attrs:{src:e,alt:""}}),i("div",{staticClass:"delete"},[i("van-icon",{staticStyle:{position:"absolute"},attrs:{name:"clear",size:"30px"},on:{click:function(e){return e.stopPropagation(),t.onSampleItemDeleteClick(s)}}})],1)])}),t.sampleImgArray.length<t.sampleImgCount?i("van-swipe-item",{staticClass:"swipe-item"},[i("div",{staticClass:"swipe-img plus-div"},[i("van-uploader",{attrs:{"after-read":t.onRead,name:"sampleLoader","max-size":1048576},on:{oversize:t.uploadImgOversize}},[i("van-icon",{attrs:{name:"add-o",size:"80px"}})],1)],1)]):t._e()],2)],1),i("van-collapse-item",{attrs:{title:"操作说明",label:"简单易懂的操作指南将大幅度提高接单效率",name:"2"}},[i("van-swipe",{attrs:{autoplay:0,width:t.vanSwipeWidth,height:t.vanSwipeHeight,loop:!1,"show-indicators":!1}},[t._l(t.explainImgArray,function(e,s){return i("van-swipe-item",{key:s,staticClass:"swipe-item",on:{click:function(e){return t.onExplainItemClick(s)}}},[i("img",{staticClass:"swipe-img",staticStyle:{position:"relative"},attrs:{src:e,alt:""}}),i("div",{staticClass:"delete"},[i("van-icon",{attrs:{name:"clear",size:"30px"},on:{click:function(e){return e.stopPropagation(),t.onExplainItemDeleteClick(s)}}})],1)])}),t.sampleImgArray.length<5?i("van-swipe-item",{staticClass:"swipe-item"},[i("div",{staticClass:"swipe-img plus-div"},[i("van-uploader",{attrs:{"after-read":t.onRead,name:"explainLoader","max-size":1048576},on:{oversize:t.uploadImgOversize}},[i("van-icon",{attrs:{name:"add-o",size:"80px"}})],1)],1)]):t._e()],2)],1)],1),i("van-field",{attrs:{label:"链接",placeholder:"请输入准确链接地址，如无可不填"},model:{value:t.missionUrl,callback:function(e){t.missionUrl=e},expression:"missionUrl"}}),i("van-field",{attrs:{label:"文字验证",type:"textarea",placeholder:"如需接单者提供文字信息，请在此输入，如不需要可不填，500字以内",autosize:""},model:{value:t.textVerify,callback:function(e){t.textVerify=e},expression:"textVerify"}}),i("van-field",{attrs:{label:"备注",type:"textarea",placeholder:"200字以内",autosize:""},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)],1),i("div",{staticClass:"submit"},[i("van-button",{staticClass:"left-button",attrs:{type:"danger",round:"",size:"large"},on:{click:t.onNavBarLeftPressed}},[t._v("取消")]),i("van-button",{attrs:{type:"primary",round:"",size:"large"},on:{click:t.onCreateMissionButtonPressed}},[t._v("提交")])],1),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showMissionTypePicker,callback:function(e){t.showMissionTypePicker=e},expression:"showMissionTypePicker"}},[i("van-picker",{attrs:{columns:t.missionTypeTitles,"show-toolbar":"",title:"请选择任务类型"},on:{confirm:t.onMissionTypePickConfirm,cancel:function(e){t.showMissionTypePicker=!1}}})],1),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showPlatformTypePicker,callback:function(e){t.showPlatformTypePicker=e},expression:"showPlatformTypePicker"}},[i("van-picker",{attrs:{columns:t.platformNames,"show-toolbar":"",title:"请选择支持设备类型"},on:{confirm:t.onPlatformTypePickConfirm,cancel:function(e){t.showPlatformTypePicker=!1}}})],1),i("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.showMissionDeadLineTimePicker,callback:function(e){t.showMissionDeadLineTimePicker=e},expression:"showMissionDeadLineTimePicker"}},[i("van-datetime-picker",{attrs:{type:"datetime","min-date":t.minDate,"show-toolbar":"",title:"请选择截止时间"},on:{confirm:t.onDeadLinePickConfirm,cancel:function(e){t.showMissionDeadLineTimePicker=!1}}})],1)],1)},n=[],a=i("e814"),o=i.n(a),r=(i("96cf"),i("3b8d")),l=(i("e7e5"),i("d399")),c=(i("68ef"),i("4d75"),i("8270"),i("786d"),i("504b"),i("1988")),m=i("2b0e"),u=i("2638"),h=i.n(u),p=i("a142"),d=i("6605"),f=i("3875"),v=i("5596"),y=i("2bb1"),g=Object(p["j"])("image-preview"),P=g[0],x=g[1];function w(t){return Math.sqrt(Math.abs((t[0].clientX-t[1].clientX)*(t[0].clientY-t[1].clientY)))}var k,T=P({mixins:[d["a"],f["a"]],props:{images:Array,className:null,lazyLoad:Boolean,asyncClose:Boolean,startPosition:Number,showIndicators:Boolean,loop:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},showIndex:{type:Boolean,default:!0},minZoom:{type:Number,default:1/3},maxZoom:{type:Number,default:3},overlayClass:{type:String,default:"van-image-preview__overlay"},closeOnClickOverlay:{type:Boolean,default:!0}},data:function(){return{scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,active:0}},computed:{imageStyle:function(){var t=this.scale,e={transition:this.zooming||this.moving?"":".3s all"};return 1!==t&&(e.transform="scale3d("+t+", "+t+", 1) translate("+this.moveX/t+"px, "+this.moveY/t+"px)"),e}},watch:{value:function(){this.active=this.startPosition},startPosition:function(t){this.active=t}},methods:{onWrapperTouchStart:function(){this.touchStartTime=new Date},onWrapperTouchEnd:function(t){t.preventDefault();var e=new Date-this.touchStartTime,i=this.$refs.swipe||{},s=i.offsetX,n=void 0===s?0:s,a=i.offsetY,o=void 0===a?0:a;if(e<300&&n<10&&o<10){var r=this.active;this.resetScale(),this.$emit("close",{index:r,url:this.images[r]}),this.asyncClose||this.$emit("input",!1)}},startMove:function(t){var e=t.currentTarget,i=e.getBoundingClientRect(),s=window.innerWidth,n=window.innerHeight;this.touchStart(t),this.moving=!0,this.startMoveX=this.moveX,this.startMoveY=this.moveY,this.maxMoveX=Math.max(0,(i.width-s)/2),this.maxMoveY=Math.max(0,(i.height-n)/2)},startZoom:function(t){this.moving=!1,this.zooming=!0,this.startScale=this.scale,this.startDistance=w(t.touches)},onTouchStart:function(t){var e=t.touches,i=this.$refs.swipe||{},s=i.offsetX,n=void 0===s?0:s;1===e.length&&1!==this.scale?this.startMove(t):2!==e.length||n||this.startZoom(t)},onTouchMove:function(t){var e=t.touches;if((this.moving||this.zooming)&&(t.preventDefault(),t.stopPropagation()),this.moving){this.touchMove(t);var i=this.deltaX+this.startMoveX,s=this.deltaY+this.startMoveY;this.moveX=Object(p["i"])(i,-this.maxMoveX,this.maxMoveX),this.moveY=Object(p["i"])(s,-this.maxMoveY,this.maxMoveY)}if(this.zooming&&2===e.length){var n=w(e),a=this.startScale*n/this.startDistance;this.scale=Object(p["i"])(a,this.minZoom,this.maxZoom)}},onTouchEnd:function(t){if(this.moving||this.zooming){var e=!0;this.moving&&this.startMoveX===this.moveX&&this.startMoveY===this.moveY&&(e=!1),t.touches.length||(this.moving=!1,this.zooming=!1,this.startMoveX=0,this.startMoveY=0,this.startScale=1,this.scale<1&&this.resetScale()),e&&(t.preventDefault(),t.stopPropagation())}},onChange:function(t){this.resetScale(),this.active=t,this.$emit("change",t)},resetScale:function(){this.scale=1,this.moveX=0,this.moveY=0}},render:function(t){var e=this;if(this.value){var i=this.active,s=this.images,n=this.showIndex&&t("div",{class:x("index")},[this.slots("index")||i+1+"/"+s.length]),a=t(v["a"],{ref:"swipe",attrs:{loop:this.loop,indicatorColor:"white",initialSwipe:this.startPosition,showIndicators:this.showIndicators},on:{change:this.onChange}},[s.map(function(s,n){var a={class:x("image"),style:n===i?e.imageStyle:null,on:{touchstart:e.onTouchStart,touchmove:e.onTouchMove,touchend:e.onTouchEnd,touchcancel:e.onTouchEnd}};return t(y["a"],[e.lazyLoad?t("img",h()([{directives:[{name:"lazy",value:s}]},a])):t("img",h()([{attrs:{src:s}},a]))])})]);return t("transition",{attrs:{name:"van-fade"}},[t("div",{class:[x(),this.className],on:{touchstart:this.onWrapperTouchStart,touchend:this.onWrapperTouchEnd,touchcancel:this.onWrapperTouchEnd}},[n,a])])}}}),I={images:[],loop:!0,value:!0,minZoom:1/3,maxZoom:3,className:"",lazyLoad:!1,showIndex:!0,asyncClose:!1,startPosition:0,showIndicators:!1},b=function(){k=new(m["a"].extend(T))({el:document.createElement("div")}),document.body.appendChild(k.$el)},C=function(t,e){if(void 0===e&&(e=0),!p["g"]){k||b();var i=Array.isArray(t)?{images:t,startPosition:e}:t;return Object(c["a"])(k,I,i),k.$once("input",function(t){k.value=t}),i.onClose&&k.$once("close",i.onClose),k}};C.install=function(){m["a"].use(T)};var M=C,S=(i("7f7f"),i("a651")),L=i("f122"),z=(i("7514"),i("c0d6"));function D(t){var e=z["a"].getters.missionRuleList;return e.find(function(e,i,s){return e.typePropertyId===t})}var X={name:"CreateMission",data:function(){return{vanSwipeWidth:100,vanSwipeHeight:130,showMissionTypePicker:!1,showPlatformTypePicker:!1,showMissionDeadLineTimePicker:!1,supportPlatformIndex:0,supportPlatformPropertyId:null,missionTypeIndex:0,missionTypePropertyId:null,missionTitle:"",deadLineTime:null,minDate:new Date,price:null,count:null,collapseActiveName:"",missionUrl:"",textVerify:"",remarks:"",sampleImgArray:[],explainImgArray:[]}},computed:{totalPrice:function(){return null===this.price||void 0===this.price||null===this.count||void 0===this.count?null:this.count*this.price},missionTypes:function(){return Object(S["c"])(S["a"].MISSION_TYPE)},missionTypeTitles:function(){return this.missionTypes.map(function(t){return t.name})},supportPlatforms:function(){return Object(S["c"])(S["a"].DEVICE_TYPE)},platformNames:function(){return this.supportPlatforms.map(function(t){return t.name})},deadLineTimeString:function(){return this.deadLineTime?this.deadLineTime.format():null},missionRule:function(){return this.missionTypePropertyId?D(this.missionTypePropertyId):null},pricePlaceholder:function(){return this.missionRule?"最低出价".concat(this.missionRule.minPrice/100,"元"):""},countPlaceholder:function(){return this.missionRule?"最少".concat(this.missionRule.minCount,"单"):""},sampleImgCount:function(){return this.missionRule?this.missionRule.verifyImgCount:5}},mounted:function(){this.missionTypePropertyId=this.missionTypes[this.missionTypeIndex].id,this.supportPlatformPropertyId=this.supportPlatforms[this.supportPlatformIndex].id},methods:{onNavBarLeftPressed:function(){this.$router.back()},onNavBarRightPressed:function(){},onMissionTypePickConfirm:function(t,e){this.showMissionTypePicker=!1,this.missionTypeIndex=e,this.missionTypePropertyId=this.missionTypes[this.missionTypeIndex].id},onPlatformTypePickConfirm:function(t,e){this.showPlatformTypePicker=!1,this.supportPlatformIndex=e,this.supportPlatformPropertyId=this.supportPlatforms[this.supportPlatformIndex].id},onDeadLinePickConfirm:function(t,e){this.showMissionDeadLineTimePicker=!1,this.deadLineTime=t},onRead:function(t,e){"sampleLoader"===e.name&&this.sampleImgArray.push(t.content),"explainLoader"===e.name&&this.explainImgArray.push(t.content)},onSampleItemClick:function(t){M({images:this.sampleImgArray,startPosition:t})},onExplainItemClick:function(t){M({images:this.explainImgArray,startPosition:t})},onSampleItemDeleteClick:function(t){this.sampleImgArray.splice(t,1)},onExplainItemDeleteClick:function(t){this.explainImgArray.splice(t,1)},uploadImgOversize:function(){Object(l["a"])("单张图片最大尺寸为1MB")},onCreateMissionButtonPressed:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e={sampleImgList:this.sampleImgArray,explainImgList:this.explainImgArray,typePropertyId:this.missionTypePropertyId,mobilePropertyId:this.supportPlatformPropertyId,title:this.missionTitle,deadlineTime:this.deadLineTimeString,price:o()(100*this.price),count:this.count,url:this.missionUrl,textVerify:this.textVerify,remark:this.remarks},this.validData(e)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.httpPostWithLoading(L["c"],e);case 5:i=t.sent,i.success&&(this.$store.commit("updateUser",i.data),this.toastSuccess("创建成功"),this.$router.back());case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),validData:function(t){var e=t.deadlineTime;if(!e)return this.toastFail("请选择截止时间"),!1;var i=t.title;if(0===i.length||!i)return this.toastFail("请输入标题"),!1;if(i.length>12)return this.toastFail("标题过长"),!1;var s=/^[0-9]+$/,n=t.price;if(!n)return this.toastFail("请输入出价"),!1;if(n<this.missionRule.minPrice)return this.toastFail("最低出价为".concat(this.missionRule.minPrice/100,"元")),!1;if(n!==100*this.price)return this.toastFail("请输入正确的出价"),!1;var a=t.count;if(!a)return this.toastFail("请输入数量"),!1;if(!s.test(a))return this.toastFail("数量需为整数"),!1;if(a<this.missionRule.minCount)return this.toastFail("最低数量为".concat(this.missionRule.minCount)),!1;if(!this.sampleImgArray||0===this.sampleImgArray.length)return this.toastFail("请添加审核图样"),!1;var o=t.url;if(o.length>500)return this.toastFail("链接过长"),!1;var r=t.textVerify;if(r.length>500)return this.toastFail("文字验证过长"),!1;var l=t.remark;return!(l.length>200)||(this.toastFail("备注过长"),!1)}}},A=X,R=(i("2874"),i("2877")),N=Object(R["a"])(A,s,n,!1,null,"db543830",null);e["default"]=N.exports},"504b":function(t,e,i){},"5d6b":function(t,e,i){var s=i("e53d").parseInt,n=i("a1ce").trim,a=i("e692"),o=/^[-+]?0[xX]/;t.exports=8!==s(a+"08")||22!==s(a+"0x16")?function(t,e){var i=n(String(t),3);return s(i,e>>>0||(o.test(i)?16:10))}:s},7445:function(t,e,i){var s=i("63b6"),n=i("5d6b");s(s.G+s.F*(parseInt!=n),{parseInt:n})},a1ce:function(t,e,i){var s=i("63b6"),n=i("25eb"),a=i("294c"),o=i("e692"),r="["+o+"]",l="​",c=RegExp("^"+r+r+"*"),m=RegExp(r+r+"*$"),u=function(t,e,i){var n={},r=a(function(){return!!o[t]()||l[t]()!=l}),c=n[t]=r?e(h):o[t];i&&(n[i]=c),s(s.P+s.F*r,"String",n)},h=u.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(m,"")),t};t.exports=u},b9e9:function(t,e,i){i("7445"),t.exports=i("584a").parseInt},e692:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(t,e,i){t.exports=i("b9e9")},e85c:function(t,e,i){}}]);
//# sourceMappingURL=chunk-2060c1ca.728e7767.js.map